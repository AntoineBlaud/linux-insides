# Bpf

The **Berkeley Packet Filter** (**BPF**) is a technology used in certain computer operating systems for programs that need to, among other things, analyze network traffic. It provides a raw interface to [data link layers](https://www.wikiwand.com/en/Data\_link\_layer), permitting raw link-layer packets to be sent and received.[\[1\]](https://www.wikiwand.com/en/Berkeley\_Packet\_Filter#citenotebpf931) In addition, if the driver for the network interface supports [promiscuous mode](https://www.wikiwand.com/en/Promiscuous\_mode), it allows the interface to be put into that mode so that all packets on the [network](https://www.wikiwand.com/en/Computer\_network) can be received, even those destined to other hosts.

BPF supports filtering packets, allowing a [userspace](https://www.wikiwand.com/en/Userspace) [process](https://www.wikiwand.com/en/Process\_\(computing\)) to supply a filter program that specifies which packets it wants to receive. For example, a [tcpdump](https://www.wikiwand.com/en/Tcpdump) process may want to receive only packets that initiate a TCP connection. BPF returns only packets that pass the filter that the process supplies. This avoids copying unwanted packets from the [operating system](https://www.wikiwand.com/en/Operating\_system) [kernel](https://www.wikiwand.com/en/Kernel\_\(computer\_science\)) to the process, greatly improving performance. The filter program is in the form of instructions for a [virtual machine](https://www.wikiwand.com/en/Virtual\_machine), which are interpreted, or compiled into machine code by a [just-in-time](https://www.wikiwand.com/en/Just-in-time\_compilation) (JIT) mechanism and executed, in the kernel.

BPF is sometimes used to refer to just the filtering mechanism, rather than to the entire interface. Some systems, such as [Linux](https://www.wikiwand.com/en/Linux) and [Tru64 UNIX](https://www.wikiwand.com/en/Tru64\_UNIX), provide a raw interface to the data link layer other than the BPF raw interface but use the BPF filtering mechanisms for that raw interface. The BPF filtering mechanism is available on most [Unix-like](https://www.wikiwand.com/en/Unix-like) operating systems.

The Linux kernel provides an extended version of the BPF filtering mechanism, called **eBPF**, which uses a JIT mechanism, and which is used for packet filtering, as well as for other purposes in the kernel. eBPF is also available for [Microsoft Windows](https://www.wikiwand.com/en/Microsoft\_Windows).[\[2\]](https://www.wikiwand.com/en/Berkeley\_Packet\_Filter#citenote2)
